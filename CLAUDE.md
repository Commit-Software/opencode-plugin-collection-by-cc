# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## What This Repo Is

A collection of [OpenCode](https://opencode.ai) plugins installable via npm as `opencode-plugins-cc`. Currently provides the `/code-simplifier-cc` slash command; more commands will be added over time.

## Build & Publish Commands

```bash
bun install                 # Install dev dependencies
bun run build               # Compile index.ts → dist/ (JS bundle + .d.ts types)
npm publish                 # Builds first via prepublishOnly, then publishes to npm
```

## How the Plugin Works

OpenCode loads npm plugins at startup by calling the plugin's default export (a `Plugin` function). This plugin:
1. Receives a context object `{ $, ... }` where `$` is Bun's shell API
2. Writes `~/.config/opencode/skills/code-simplifier-cc/SKILL.md` to register the `/code-simplifier-cc` slash command
3. Returns `{}` (no event hooks needed)

**Why skills?** OpenCode discovers slash commands from SKILL.md files in `~/.config/opencode/skills/<name>/`. Writing the file at plugin load time is the mechanism to register a user-invocable `/command`.

## Key Files

- `index.ts` — Plugin entry point; defines a `skills[]` array and installs each as a SKILL.md file
- `package.json` — npm package config; name is `opencode-plugins-cc`
- `tsconfig.json` — TypeScript config with `bundler` module resolution (required by bun build)
- `dist/` — Built output (not committed); generated by `bun run build`

## Plugin Type System

The `@opencode-ai/plugin` peer dependency provides:
- `Plugin` type — `async (ctx: PluginInput) => Hooks`
- `tool()` — registers AI-callable tools (not used here)
- Available hooks: `auth`, `event`, `chat.params`, `chat.message`, `shell.env`, etc.

## Adding More Commands to This Collection

Each new command is a new entry in the `skills[]` array in `index.ts`:
1. Add an object with `name`, `description`, and `prompt` to the `skills` array
2. The `name` becomes the `/command-name` in OpenCode (must be lowercase kebab-case)
3. Add the command to the **Available Commands** section of `README.md`
